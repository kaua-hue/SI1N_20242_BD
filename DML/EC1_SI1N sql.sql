#FASE 1: CRIAR O BANCO DE DADOS (SCHEMA OU DATABASE):
#MEU PRIMEIRO BANQUINHO
#CREATE SCHEMA EC1_SI1N;

#FASE 2: SELECIONAR O NOVO SCHEMA OU DATABASE PARA USO:
#USANDO MEU BANQUINHO
USE EC1_SI1N;


# FASE 3: CRIANDO AS TABELAS SEM CHAVES ESTRANGEIRAS

#CRIANDO A TABELINHA FORNECEDORES
CREATE TABLE IF NOT EXISTS FORNECEDORES(
#NOMEDOATRIBUTO - TIPO - RESTRIÇÃO DE INTEGRIDADE(OPCIONAL)
FORNEC_COD INT PRIMARY KEY,
FORNEC_NOME VARCHAR(100) NOT NULL,
FORNEC_RUA VARCHAR(100) NOT NULL,
FORNEC_NUMRUA VARCHAR(50),
FORNEC_BAIRRO VARCHAR(50),
FORNEC_CIDADE VARCHAR(50),
FORNEC_ESTADO VARCHAR(10),
FORNEC_PAIS VARCHAR(50) ,
FORNEC_CODPOSTAL VARCHAR(10),
FORNEC_TELEFONE VARCHAR(15),
FORNEC_CONTATO TEXT NOT NULL

INSERT INTO Fornecedores (FORNEC_COD, FORNEC_NOME, FORNEC_RUA, FORNEC_NUMRUA, FORNEC_BAIRRO, FORNEC_CIDADE, FORNEC_ESTADO, FORNEC_PAIS, FORNEC_CODPOSTAL, FORNEC_TELEFONE, FORNEC_CONTATO)
VALUES (1, 'Fornecedor A', 'Rua X', '123', 'Centro', 'São Paulo', 'SP', 'Brasil', '01000-000', '(11) 12345-6789', 'Carlos Silva');

INSERT INTO Fornecedores (FORNEC_COD, FORNEC_NOME, FORNEC_RUA, FORNEC_NUMRUA, FORNEC_BAIRRO, FORNEC_CIDADE, FORNEC_ESTADO, FORNEC_PAIS, FORNEC_CODPOSTAL, FORNEC_TELEFONE, FORNEC_CONTATO)
VALUES (2, 'Fornecedor B', 'Avenida Y', '456', 'Jardim', 'Rio de Janeiro', 'RJ', 'Brasil', '20000-000', '(21) 98765-4321', 'Maria Oliveira');

INSERT INTO Fornecedores (FORNEC_COD, FORNEC_NOME, FORNEC_RUA, FORNEC_NUMRUA, FORNEC_BAIRRO, FORNEC_CIDADE, FORNEC_ESTADO, FORNEC_PAIS, FORNEC_CODPOSTAL, FORNEC_TELEFONE, FORNEC_CONTATO)
VALUES (3, 'Fornecedor C', 'Rua Z', '789', 'Vila Nova', 'Belo Horizonte', 'MG', 'Brasil', '31000-000', '(31) 93456-7890', 'Lucas Costa');

INSERT INTO Fornecedores (FORNEC_COD, FORNEC_NOME, FORNEC_RUA, FORNEC_NUMRUA, FORNEC_BAIRRO, FORNEC_CIDADE, FORNEC_ESTADO, FORNEC_PAIS, FORNEC_CODPOSTAL, FORNEC_TELEFONE, FORNEC_CONTATO)
VALUES (4, 'Fornecedor D', 'Rua W', '101', 'Santa Clara', 'Curitiba', 'PR', 'Brasil', '80000-000', '(41) 93333-4444', 'Fernanda Souza');

INSERT INTO Fornecedores (FORNEC_COD, FORNEC_NOME, FORNEC_RUA, FORNEC_NUMRUA, FORNEC_BAIRRO, FORNEC_CIDADE, FORNEC_ESTADO, FORNEC_PAIS, FORNEC_CODPOSTAL, FORNEC_TELEFONE, FORNEC_CONTATO)
VALUES (5, 'Fornecedor E', 'Avenida Q', '202', 'Centro', 'Porto Alegre', 'RS', 'Brasil', '90000-000', '(51) 92222-3333', 'José Santos');

UPDATE Fornecedores
SET FORNEC_TELEFONE = '(11) 998132-7777'
WHERE FORNEC_COD = 1;

UPDATE Fornecedores
SET FORNEC_CONTATO = 'Marcela Ferreira'
WHERE FORNEC_COD = 2;

DELETE FROM Fornecedores
WHERE FORNEC_COD = 3;
);

ALTER TABLE FORNECEDORES
ADD COLUMN data_contrato DATE;

#CRIANDO A TABELINHA FILIAIS
CREATE TABLE IF NOT EXISTS FILIAIS(
FILIAL_COD INT PRIMARY KEY,
FILIAL_NOME VARCHAR(100),
FILIAL_RUA VARCHAR(100),
FILIAL_NUMRUA VARCHAR(50),
FILIAL_BAIRRO VARCHAR(50),
FILIAL_CIDADE VARCHAR(50),
FILIAL_ESTADO VARCHAR(10),
FILIAL_PAIS VARCHAR(50),
FILIAL_CODPOSTAL VARCHAR(10),
FILIAL_CAPACIDADE INT

INSERT INTO Filiais (FILIAL_COD, FILIAL_NOME, FILIAL_RUA, FILIAL_NUMRUA, FILIAL_BAIRRO, FILIAL_CIDADE, FILIAL_ESTADO, FILIAL_PAIS, FILIAL_CODPOSTAL, FILIAL_CAPACIDADE)
VALUES (1, 'Filial A', 'Rua X', '123', 'Centro', 'São Paulo', 'SP', 'Brasil', '01000-000', 500);

INSERT INTO Filiais (FILIAL_COD, FILIAL_NOME, FILIAL_RUA, FILIAL_NUMRUA, FILIAL_BAIRRO, FILIAL_CIDADE, FILIAL_ESTADO, FILIAL_PAIS, FILIAL_CODPOSTAL, FILIAL_CAPACIDADE)
VALUES (2, 'Filial B', 'Avenida Y', '456', 'Jardim', 'Rio de Janeiro', 'RJ', 'Brasil', '20000-000', 300);

INSERT INTO Filiais (FILIAL_COD, FILIAL_NOME, FILIAL_RUA, FILIAL_NUMRUA, FILIAL_BAIRRO, FILIAL_CIDADE, FILIAL_ESTADO, FILIAL_PAIS, FILIAL_CODPOSTAL, FILIAL_CAPACIDADE)
VALUES (3, 'Filial C', 'Rua Z', '789', 'Vila Nova', 'Belo Horizonte', 'MG', 'Brasil', '31000-000', 400);

INSERT INTO Filiais (FILIAL_COD, FILIAL_NOME, FILIAL_RUA, FILIAL_NUMRUA, FILIAL_BAIRRO, FILIAL_CIDADE, FILIAL_ESTADO, FILIAL_PAIS, FILIAL_CODPOSTAL, FILIAL_CAPACIDADE)
VALUES (4, 'Filial D', 'Rua W', '101', 'Santa Clara', 'Curitiba', 'PR', 'Brasil', '80000-000', 250);

INSERT INTO Filiais (FILIAL_COD, FILIAL_NOME, FILIAL_RUA, FILIAL_NUMRUA, FILIAL_BAIRRO, FILIAL_CIDADE, FILIAL_ESTADO, FILIAL_PAIS, FILIAL_CODPOSTAL, FILIAL_CAPACIDADE)
VALUES (5, 'Filial E', 'Avenida Q', '202', 'Centro', 'Porto Alegre', 'RS', 'Brasil', '90000-000', 350);

UPDATE Filiais
SET FILIAL_CAPACIDADE = 600
WHERE FILIAL_COD = 1;

UPDATE Filiais
SET FILIAL_NOME = 'Filial F'
WHERE FILIAL_COD = 2;

DELETE FROM Filiais
WHERE FILIAL_COD = 3;
);

ALTER TABLE FILIAIS
DROP COLUMN FILIAL_NUMRUA;

ALTER TABLE FILIAIS
MODIFY COLUMN FILIAL_NOME VARCHAR(30);

#CRIANDO A TABELINHA PRODUTOS
CREATE TABLE IF NOT EXISTS PRODUTOS(
PROD_COD INT PRIMARY KEY,
PROD_NOME VARCHAR(50) NOT NULL,
PROD_DESCRICAO VARCHAR(300),
PROD_ESPECTEC VARCHAR(100),
PROD_QUANT INT,
PROD_PRECOUNIT DECIMAL(10,2),
PROD_UNIDMEDIDA VARCHAR(10),
PROD_ESTOQ_MIN INT

INSERT INTO Produtos (PROD_COD, PROD_NOME, PROD_DESCRICAO, PROD_ESPECTEC, PROD_QUANT, PROD_PRECOUNIT, PROD_UNIDMEDIDA, PROD_ESTOQ_MIN)
VALUES (1, 'Produto A', 'Produto de alta qualidade', 'Especificação A', 100, 10.50, 'unidade', 10);

INSERT INTO Produtos (PROD_COD, PROD_NOME, PROD_DESCRICAO, PROD_ESPECTEC, PROD_QUANT, PROD_PRECOUNIT, PROD_UNIDMEDIDA, PROD_ESTOQ_MIN)
VALUES (2, 'Produto B', 'Produto econômico', 'Especificação B', 200, 5.25, 'unidade', 20);

INSERT INTO Produtos (PROD_COD, PROD_NOME, PROD_DESCRICAO, PROD_ESPECTEC, PROD_QUANT, PROD_PRECOUNIT, PROD_UNIDMEDIDA, PROD_ESTOQ_MIN)
VALUES (3, 'Produto C', 'Produto de uso doméstico', 'Especificação C', 50, 15.75, 'litro', 5);

INSERT INTO Produtos (PROD_COD, PROD_NOME, PROD_DESCRICAO, PROD_ESPECTEC, PROD_QUANT, PROD_PRECOUNIT, PROD_UNIDMEDIDA, PROD_ESTOQ_MIN)
VALUES (4, 'Produto D', 'Produto industrial', 'Especificação D', 30, 100.00, 'kg', 10);

INSERT INTO Produtos (PROD_COD, PROD_NOME, PROD_DESCRICAO, PROD_ESPECTEC, PROD_QUANT, PROD_PRECOUNIT, PROD_UNIDMEDIDA, PROD_ESTOQ_MIN)
VALUES (5, 'Produto E', 'Produto alimentar', 'Especificação E', 500, 3.60, 'unidade', 50);

UPDATE Produtos
SET PROD_QUANT = 120
WHERE PROD_COD = 1;

UPDATE Produtos
SET PROD_PRECOUNIT = 12.00
WHERE PROD_COD = 2;

DELETE FROM Produtos
WHERE PROD_COD = 3;
);


ALTER TABLE PRODUTOS
CHANGE COLUMN PROD_DESCRICAO PROD_DESCR TEXT;

#FASE 4: CRIAR AS TABELAS COM DEPENDÊNCIA DE CHAVE ESTRANGEIRA

#CRIANDO A TABELA PEDIDOS
CREATE TABLE IF NOT EXISTS PEDIDOS(
PED_CODIGO INT PRIMARY KEY,
PED_DATA DATE NOT NULL,
PED_HORA TIME NOT NULL,
PED_PREVISAO DATE,
PED_STATUS ENUM('PENDENTE','CONCLUÍDO','EM ESPERA', 'CANCELADO') NOT NULL,
PED_FORNECEDOR INT, 
CONSTRAINT FK_FORNECEDOR FOREIGN KEY (PED_FORNECEDOR)  
REFERENCES FORNECEDORES (FORNEC_COD) 

INSERT INTO Pedidos (PED_CODIGO, PED_DATA, PED_HORA, PED_PREVISAO, PED_STATUS, PED_FORNECEDOR)
VALUES (1, '2024-11-01', '14:30:00', '2024-11-05', 'PENDENTE', 1);

INSERT INTO Pedidos (PED_CODIGO, PED_DATA, PED_HORA, PED_PREVISAO, PED_STATUS, PED_FORNECEDOR)
VALUES (2, '2024-11-02', '09:00:00', '2024-11-06', 'EM ESPERA', 2);

INSERT INTO Pedidos (PED_CODIGO, PED_DATA, PED_HORA, PED_PREVISAO, PED_STATUS, PED_FORNECEDOR)
VALUES (3, '2024-11-03', '16:45:00', '2024-11-07', 'CONCLUÍDO', 3);

INSERT INTO Pedidos (PED_CODIGO, PED_DATA, PED_HORA, PED_PREVISAO, PED_STATUS, PED_FORNECEDOR)
VALUES (4, '2024-11-04', '11:30:00', '2024-11-08', 'CANCELADO', 4);

INSERT INTO Pedidos (PED_CODIGO, PED_DATA, PED_HORA, PED_PREVISAO, PED_STATUS, PED_FORNECEDOR)
VALUES (5, '2024-11-05', '13:15:00', '2024-11-09', 'PENDENTE', 5);

UPDATE Pedidos
SET PED_STATUS = 'EM ESPERA'
WHERE PED_CODIGO = 1;

UPDATE Pedidos
SET PED_PREVISAO = '2024-11-10'
WHERE PED_CODIGO = 2;

DELETE FROM Pedidos
WHERE PED_CODIGO = 3;
);

#CRIANDO A TABELA RECEBIMENTOS (VEIO DEPOIS POIS TEM DEPENDÊNCIA DE PEDIDOS)
CREATE TABLE IF NOT EXISTS RECEBIMENTOS(
RECEB_CODIGO INT PRIMARY KEY,    
RECEB_DATA DATE NOT NULL,
RECEB_HORA TIME NOT NULL,
RECEB_QUANT_PROD INT NOT NULL,
RECEB_CONDICAO VARCHAR(100) NOT NULL,
RECEB_PEDIDOS INT,
CONSTRAINT FK_PEDIDOS FOREIGN KEY(RECEB_PEDIDOS) REFERENCES PEDIDOS(PED_CODIGO)

INSERT INTO RECEBIMENTOS (RECEB_DATA, RECEB_HORA, RECEB_QUANT_PROD, RECEB_CONDICAO, RECEB_PEDIDOS)
VALUES ('2024-11-01', '15:30:00', 100, 'Bom estado', 1);

INSERT INTO RECEBIMENTOS (RECEB_DATA, RECEB_HORA, RECEB_QUANT_PROD, RECEB_CONDICAO, RECEB_PEDIDOS)
VALUES ('2024-11-02', '10:15:00', 200, 'Bom estado', 2);

INSERT INTO RECEBIMENTOS (RECEB_DATA, RECEB_HORA, RECEB_QUANT_PROD, RECEB_CONDICAO, RECEB_PEDIDOS)
VALUES ('2024-11-03', '17:45:00', 50, 'Danos observados', 3);

INSERT INTO RECEBIMENTOS (RECEB_DATA, RECEB_HORA, RECEB_QUANT_PROD, RECEB_CONDICAO, RECEB_PEDIDOS)
VALUES ('2024-11-04', '12:00:00', 30, 'Bom estado', 4);

INSERT INTO RECEBIMENTOS (RECEB_DATA, RECEB_HORA, RECEB_QUANT_PROD, RECEB_CONDICAO, RECEB_PEDIDOS)
VALUES ('2024-11-05', '14:00:00', 250, 'Bom estado', 5);

UPDATE RECEBIMENTOS
SET RECEB_CONDICAO = 'Danos observados'
WHERE RECEB_CODIGO = 3;

UPDATE RECEBIMENTOS
SET RECEB_QUANT_PROD = 120
WHERE RECEB_CODIGO = 2;

DELETE FROM RECEBIMENTOS
WHERE RECEB_CODIGO = 4;
);

#FASE 5: CRIANDO AS TABELAS ASSOCIATIVAS (ENTIDADES ASSOCIATIVAS)
DROP TABLE RECEBIMENTOS;

#CRIANDO A TABELA PEDIDOS_PRODUTOS
CREATE TABLE IF NOT EXISTS PEDIDOS_PRODUTOS(
PDPR_PEDIDOS INT,
PDPR_PRODUTOS INT,
PRIMARY KEY(PDPR_PEDIDOS,PDPR_PRODUTOS),
PDPR_QUANT INT NOT NULL,
CONSTRAINT PDPR_FK_PEDIDOS FOREIGN KEY(PDPR_PEDIDOS) REFERENCES PEDIDOS(PED_CODIGO),
CONSTRAINT PDPR_FK_PRODUTOS FOREIGN KEY(PDPR_PRODUTOS) REFERENCES PRODUTOS(PROD_COD)

INSERT INTO PEDIDOS_PRODUTOS (PDPR_PEDIDOS, PDPR_PRODUTOS, PDPR_QUANT)
VALUES (1, 101, 2);

INSERT INTO PEDIDOS_PRODUTOS (PDPR_PEDIDOS, PDPR_PRODUTOS, PDPR_QUANT)
VALUES (1, 102, 5);

INSERT INTO PEDIDOS_PRODUTOS (PDPR_PEDIDOS, PDPR_PRODUTOS, PDPR_QUANT)
VALUES (2, 103, 1);

INSERT INTO PEDIDOS_PRODUTOS (PDPR_PEDIDOS, PDPR_PRODUTOS, PDPR_QUANT)
VALUES (3, 101, 10);

INSERT INTO PEDIDOS_PRODUTOS (PDPR_PEDIDOS, PDPR_PRODUTOS, PDPR_QUANT)
VALUES (3, 104, 3);

UPDATE PEDIDOS_PRODUTOS
SET PDPR_QUANT = 4
WHERE PDPR_PEDIDOS = 1 AND PDPR_PRODUTOS = 101;

UPDATE PEDIDOS_PRODUTOS
SET PDPR_QUANT = 5
WHERE PDPR_PEDIDOS = 3 AND PDPR_PRODUTOS = 104;

DELETE FROM PEDIDOS_PRODUTOS
WHERE PDPR_PEDIDOS = 1 AND PDPR_PRODUTOS = 102;
);

#CRIANDO A TABELA FILIAIS_PRODUTOS
CREATE TABLE IF NOT EXISTS FILIAIS_PRODUTOS(
FLPR_FILIAL INT,
FLPR_PRODUTOS INT,
PRIMARY KEY(FLPR_FILIAL,FLPR_PRODUTOS),
FLPR_QUANT DECIMAL(10,3) NOT NULL,
CONSTRAINT FLPR_FK_FILIAIS FOREIGN KEY(FLPR_FILIAL) REFERENCES FILIAIS(FILIAL_COD),
CONSTRAINT FLPR_FK_PRODUTOS FOREIGN KEY(FLPR_PRODUTOS) REFERENCES PRODUTOS(PROD_COD)

INSERT INTO FILIAIS_PRODUTOS (FLPR_FILIAL, FLPR_PRODUTOS)
VALUES (1, 1001);

INSERT INTO FILIAIS_PRODUTOS (FLPR_FILIAL, FLPR_PRODUTOS)
VALUES (2, 1002);

INSERT INTO FILIAIS_PRODUTOS (FLPR_FILIAL, FLPR_PRODUTOS)
VALUES (1, 1003);

INSERT INTO FILIAIS_PRODUTOS (FLPR_FILIAL, FLPR_PRODUTOS)
VALUES (3, 1004);

INSERT INTO FILIAIS_PRODUTOS (FLPR_FILIAL, FLPR_PRODUTOS)
VALUES (2, 1005);

UPDATE Filiais_Produtos
SET FLPR_FILIAL = 3
WHERE FLPR_PRODUTOS  FLPR_FILIAL = 1;

UPDATE FILIAIS_PRODUTOS
SET FLPR_PRODUTOS = 1006
WHERE FLPR_PRODUTOS  FLPR_FILIAL= 2;
);

#CRIAR A TABELA FORNECEDORES_PRODUTOS
CREATE TABLE IF NOT EXISTS FORNECEDORES_PRODUTOS(
FRPR_FORNECEDOR INT,
FRPR_PRODUTOS INT,
PRIMARY KEY(FRPR_FORNECEDOR, FRPR_PRODUTOS),
CONSTRAINT FRPR_FK_FORNECEDORES FOREIGN KEY(FRPR_FORNECEDOR)
REFERENCES FORNECEDORES(FORNEC_COD),
CONSTRAINT FRPR_FK_PRODUTOS FOREIGN KEY(FRPR_PRODUTOS) 
REFERENCES PRODUTOS(PROD_COD)

INSERT INTO FORNECEDORES_PRODUTOS (FRPR_FORNECEDOR, FRPR_PRODUTOS)
VALUES (1, 1001);

INSERT INTO FORNECEDORES_PRODUTOS (FRPR_FORNECEDOR, FRPR_PRODUTOS)
VALUES (2, 1002);

INSERT INTO FORNECEDORES_PRODUTOS (FRPR_FORNECEDOR, FRPR_PRODUTOS)
VALUES (1, 1003);

INSERT INTO FORNECEDORES_PRODUTOS (FRPR_FORNECEDOR, FRPR_PRODUTOS)
VALUES (3, 1004);

INSERT INTO FORNECEDORES_PRODUTOS (FRPR_FORNECEDOR, FRPR_PRODUTOS)
VALUES (2, 1005);

UPDATE Fornecedores_Produtos
SET FRPR_FORNECEDOR = 4
WHERE FRPR_FORNECEDOR, FRPR_PRODUTOS = 1;

UPDATE Fornecedores_Produtos
SET FRPR_PRODUTOS = 1006
WHERE FRPR_FORNECEDOR, FRPR_PRODUTOS = 2;

DELETE FROM Fornecedores_Produtos
WHERE FRPR_FORNECEDOR, FRPR_PRODUTOS = 3;
);